<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–í—Ö–æ–¥ –≤ –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç</title>
    <link rel="stylesheet" href="/styles.css">
</head>
<body>
    <div id="root">
        <div style="text-align: center; padding: 50px; color: white;">
            <h2>–ó–∞–≥—Ä—É–∑–∫–∞ –ª–∏—á–Ω–æ–≥–æ –∫–∞–±–∏–Ω–µ—Ç–∞...</h2>
        </div>
    </div>

    <script src="https://unpkg.com/react@17/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@17/umd/react-dom.development.js"></script>

    <script>
        console.log('üöÄ Cabinet.js –Ω–∞—á–∞–ª –∑–∞–≥—Ä—É–∑–∫—É...');

        // –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –ª–∏—á–Ω–æ–≥–æ –∫–∞–±–∏–Ω–µ—Ç–∞
        function Cabinet() {
            console.log('üîß Cabinet –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —Å–æ–∑–¥–∞–Ω');

            // –°–æ—Å—Ç–æ—è–Ω–∏–µ –¥–ª—è —Ñ–æ—Ä–º—ã –≤—Ö–æ–¥–∞
            const [loginData, setLoginData] = React.useState({
                username: '',
                password: ''
            });
            const [isLoading, setIsLoading] = React.useState(false);

            console.log('üîÑ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–æ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:', loginData);

            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ–ª–µ–π –≤–≤–æ–¥–∞
            const handleInputChange = (field, value) => {
                console.log('üìù –ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø–æ–ª—è:', field, value);
                setLoginData(prev => ({
                    ...prev,
                    [field]: value
                }));
            };

            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–æ—Ä–º—ã
            const handleLogin = async (e) => {
                e.preventDefault();

                console.log('üîÑ –ù–∞—á–∞–ª–æ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤—Ö–æ–¥–∞', loginData);

                if (!loginData.username || !loginData.password) {
                    console.log('‚ùå –ü—É—Å—Ç—ã–µ –ø–æ–ª—è');
                    alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è');
                    return;
                }

                setIsLoading(true);
                console.log('‚è≥ –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω isLoading:', true);

                try {
                    console.log('üì® –û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –Ω–∞ /api/login...');
                    const response = await fetch('/api/login', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            username: loginData.username,
                            password: loginData.password
                        })
                    });

                    console.log('‚úÖ –û—Ç–≤–µ—Ç –ø–æ–ª—É—á–µ–Ω, —Å—Ç–∞—Ç—É—Å:', response.status);
                    const data = await response.json();
                    console.log('üìä –î–∞–Ω–Ω—ã–µ –æ—Ç–≤–µ—Ç–∞:', data);

                    if (data.success) {
                        console.log('‚úÖ –£—Å–ø–µ—à–Ω—ã–π –≤—Ö–æ–¥, —Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞:', data.redirect_url);
                        alert('‚úÖ ' + data.message);
                        // –†–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –∫–∞–±–∏–Ω–µ—Ç
                        window.location.href = data.redirect_url;
                    } else {
                        console.log('‚ùå –û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞:', data.message);
                        alert('‚ùå ' + data.message);
                    }
                } catch (error) {
                    console.error('‚ùå –û—à–∏–±–∫–∞ fetch:', error);
                    alert('‚ö†Ô∏è –û—à–∏–±–∫–∞ –ø—Ä–∏ –≤—Ö–æ–¥–µ –≤ —Å–∏—Å—Ç–µ–º–µ');
                } finally {
                    setIsLoading(false);
                    console.log('‚è≥ –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω isLoading:', false);
                }
            };

            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–∞–∂–∞—Ç–∏—è Enter
            const handleKeyPress = (e) => {
                console.log('‚å®Ô∏è –ù–∞–∂–∞—Ç–∞ –∫–ª–∞–≤–∏—à–∞:', e.key);
                if (e.key === 'Enter') {
                    handleLogin(e);
                }
            };

            console.log('üé® –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞...');

            return React.createElement('div', {className: 'container'},
                // –ù–∞–≤–∏–≥–∞—Ü–∏–æ–Ω–Ω–æ–µ –º–µ–Ω—é
                React.createElement('nav', {className: 'navbar'},
                    React.createElement('div', {className: 'nav-brand'},
                        React.createElement('span', null, 'üë§ –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç')
                    ),
                    React.createElement('ul', {className: 'nav-menu'},
                        React.createElement('li', null,
                            React.createElement('a', {href: '/'}, '–ì–ª–∞–≤–Ω–∞—è')
                        ),
                        React.createElement('li', null,
                            React.createElement('a', {href: '#login'}, '–í—Ö–æ–¥')
                        )
                    )
                ),

                // –ó–∞–≥–æ–ª–æ–≤–æ–∫
                React.createElement('header', {className: 'header', id: 'login'},
                    React.createElement('div', {className: 'header-info'},
                        React.createElement('h1', null, '–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç'),
                        React.createElement('h2', null, '–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ–±—É—á–µ–Ω–∏–µ–º'),
                        React.createElement('p', {className: 'subtitle'}, '–û—Ç—Å–ª–µ–∂–∏–≤–∞–π—Ç–µ –ø—Ä–æ–≥—Ä–µ—Å—Å –∏ –ø–ª–∞–Ω–∏—Ä—É–π—Ç–µ –∑–∞–Ω—è—Ç–∏—è'),

                        // –ë–ª–æ–∫ —Å —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
                        React.createElement('div', {className: 'test-accounts'},
                            React.createElement('h3', null, '–¢–µ—Å—Ç–æ–≤—ã–µ –∞–∫–∫–∞—É–Ω—Ç—ã:'),
                            React.createElement('div', {className: 'account-list'},
                                React.createElement('div', {className: 'account-item'},
                                    React.createElement('strong', null, '–†–µ–ø–µ—Ç–∏—Ç–æ—Ä:'),
                                    ' –ª–æ–≥–∏–Ω ',
                                    React.createElement('code', null, 'tutor'),
                                    ', –ø–∞—Ä–æ–ª—å ',
                                    React.createElement('code', null, 'tutor')
                                ),

                            )
                        )
                    )
                ),

                // –§–æ—Ä–º–∞ –≤—Ö–æ–¥–∞
                React.createElement('section', {className: 'login-section'},
                    React.createElement('h2', null, 'üîê –í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É'),
                    React.createElement('div', {className: 'login-container'},
                        React.createElement('form', {className: 'login-form', onSubmit: handleLogin},
                            React.createElement('div', {className: 'form-group'},
                                React.createElement('label', null, '–õ–æ–≥–∏–Ω:'),
                                React.createElement('input', {
                                    type: 'text',
                                    placeholder: '–í–≤–µ–¥–∏—Ç–µ –ª–æ–≥–∏–Ω',
                                    value: loginData.username,
                                    onChange: (e) => handleInputChange('username', e.target.value),
                                    onKeyPress: handleKeyPress,
                                    disabled: isLoading
                                })
                            ),
                            React.createElement('div', {className: 'form-group'},
                                React.createElement('label', null, '–ü–∞—Ä–æ–ª—å:'),
                                React.createElement('input', {
                                    type: 'password',
                                    placeholder: '–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å',
                                    value: loginData.password,
                                    onChange: (e) => handleInputChange('password', e.target.value),
                                    onKeyPress: handleKeyPress,
                                    disabled: isLoading
                                })
                            ),
                            React.createElement('button', {
                                type: 'submit',
                                className: 'login-btn',
                                disabled: isLoading
                            }, isLoading ? '‚è≥ –í—Ö–æ–¥...' : 'üîê –í–æ–π—Ç–∏'),
                            React.createElement('div', {className: 'login-links'},
                                React.createElement('a', {href: '#', className: 'forgot-password'}, '–ó–∞–±—ã–ª–∏ –ø–∞—Ä–æ–ª—å?')
                            )
                        )
                    )
                )
            );
        }

        console.log('üìÅ Cabinet.js –∑–∞–≥—Ä—É–∂–µ–Ω');
    </script>
    <script>
        console.log('üîÑ –ó–∞–≥—Ä—É–∑–∫–∞ Cabinet –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞...');

        document.addEventListener('DOMContentLoaded', function() {
            console.log('‚úÖ DOM –∑–∞–≥—Ä—É–∂–µ–Ω, —Ä–µ–Ω–¥–µ—Ä–∏–º Cabinet...');

            if (typeof React !== 'undefined' && typeof ReactDOM !== 'undefined' && typeof Cabinet !== 'undefined') {
                // –ò—Å–ø–æ–ª—å–∑—É–µ–º —Å—Ç–∞—Ä—ã–π –º–µ—Ç–æ–¥ –¥–ª—è React 16/17
                ReactDOM.render(React.createElement(Cabinet), document.getElementById('root'));
                console.log('‚úÖ Cabinet –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –æ—Ç—Ä–µ–Ω–¥–µ—Ä–µ–Ω (React 16/17)');
            } else {
                console.error('‚ùå React –∏–ª–∏ Cabinet –Ω–µ –Ω–∞–π–¥–µ–Ω—ã');
            }
        });
    </script>
</body>
</html>